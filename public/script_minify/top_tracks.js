let t=!1;const e=async function(i){return new Promise((e,t)=>{setTimeout(e,i)})},o=async function(){if(t)for(;t;)await e(100);else{t=!0;let e;e=await fetch("/gettoken"),e=await e.json(),e.relogback?l(!1):(window.localStorage.token=e.data.token,window.localStorage.validuntil=e.data.validuntil,t=!1)}},s=async function(){let t;if(t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),t=await t.json(),t.error)401!=t.error.status&&400!=t.error.status||(await o(),await e(1e3),await s());else{let e;e=t.images[0]?t.images[0].url:"/img/user.png",$("#profile").attr("src",e)}},l=function(e){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),e&&(window.localStorage.force=!0),window.location.replace("/")};let a=!1;const r=function(){a=a?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};let n=!1;$("#profile_h").click(function(){n=!0,r()}),$("#dropdown_options").click(function(){n=!0}),$("#logout").click(function(){l(!0)}),$(window).click(function(){n?n=!1:a&&r()}),isLoggedOut||s();const d=function(){$("#holder").addClass("margin0")},c=function(){$("#holder").removeClass("margin0")};let f=44.5;$(window).width()/parseFloat($("body").css("font-size"))<f&&d(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){this.innerWidth;($(window).width()/parseFloat($("body").css("font-size"))<f?d:c)()},async function(h){const e=async function(d){var c="createElement",f="setAttribute",m="items",w="appendChild";if(!(2<d)){let n;if(n=await fetch("https://api.spotify.com/v1/me/top/tracks?limit=50&time_range="+["long_term","medium_term","short_term"][d],{method:"GET",headers:{Authorization:window.localStorage.token}}),n=await n.json(),n.error)401!=n.error.status&&400!=n.error.status||(await o(),await e(d));else{for(h.getElementById(`listTrack${d}`).innerHTML="",i=0;i<n[m].length;i++){let e=h[c]("div");e[f]("id",`listTrack${d}N${i}`),e[f]("class","list");let t=h[c]("div");t[f]("class","listNumber"),t.innerHTML=i+1;let o=h[c]("div");o[f]("id",`listTrack${d}N${i}AlbumHolder`),o[f]("class","listTrackAlbumHolder");let s=h[c]("img");s[f]("id",`listTrack${d}N${i}Album`),s[f]("class","listTrackAlbum"),s[f]("src",n[m][i].album.images[1].url);let l=h[c]("div");l[f]("id",`listTrack${d}N${i}InfoHolder`),l[f]("class","listTrackInfoHolder");let a=h[c]("div");a[f]("class","listTrackTitle"),a.innerHTML=n[m][i].name;let r=h[c]("div");for(r[f]("class","listTrackArtist"),j=0;j<n[m][i].artists.length;j++)r.innerHTML+=n[m][i].artists[j].name,j!=n[m][i].artists.length-1&&(r.innerHTML+=", ");l[w](a),l[w](r),o[w](s),e[w](t),e[w](o),e[w](l),h.getElementById(`listTrack${d}`)[w](e)}for(i=0;i<n[m].length;i++)$(`#listTrack${d}N${i}AlbumHolder`).off().on("click",{res:n,i:i},function(e){e=e.data.res.items[e.data.i].album.external_urls.spotify;isMobile()?location.href=e:window.open(e)}),$(`#listTrack${d}N${i}InfoHolder`).off().on("click",{res:n,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)})}}},t=async function(n){var d="createElement",c="setAttribute",f="items",m="appendChild";if(!(2<n)){let r;if(r=await fetch("https://api.spotify.com/v1/me/top/artists?limit=50&time_range="+["long_term","medium_term","short_term"][n],{method:"GET",headers:{Authorization:window.localStorage.token}}),r=await r.json(),r.error)401!=r.error.status&&400!=r.error.status||(await o(),await t(n));else{for(h.getElementById(`listArtist${n}`).innerHTML="",i=0;i<r[f].length;i++){let e=h[d]("div");e[c]("id",`listArtist${n}N${i}`),e[c]("class","list");let t=h[d]("div");t[c]("class","listNumber"),t.innerHTML=i+1;let o=h[d]("div");o[c]("id",`listArtist${n}N${i}ProfileHolder`),o[c]("class","listArtistProfileHolder");let s=h[d]("img");s[c]("id",`listArtist${n}N${i}Profile`),s[c]("class","listArtistProfile"),s[c]("src",r[f][i].images[1].url);let l=h[d]("div");l[c]("id",`listArtist${n}N${i}InfoHolder`),l[c]("class","listArtistInfoHolder");let a=h[d]("p");a[c]("id",`listArtist${n}N${i}Info`),a[c]("class","listArtistInfo"),a.innerHTML=r[f][i].name,o[m](s),l[m](a),e[m](t),e[m](o),e[m](l),h.getElementById(`listArtist${n}`)[m](e)}for(i=0;i<r[f].length;i++)$(`#listArtist${n}N${i}ProfileHolder`).off().on("click",{res:r,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)}),$(`#listArtist${n}N${i}InfoHolder`).off().on("click",{res:r,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)})}}};e(0),e(1),e(2),t(0),t(1),t(2)}(document);let m=0,w=0;const h=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0);$("#listTrack").addClass("none"),$("#listArtist").addClass("none"),$(`#list${["Track","Artist"][e]}`).removeClass("none"),m=e,$("#trackSelector").removeClass("selected").removeClass("selectedLight"),$("#artistSelector").removeClass("selected").removeClass("selectedLight"),$(`#${["track","artist"][e]}Selector`).addClass(t?"selectedLight":"selected")},g=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0),$("#listTrack0").addClass("none"),$("#listTrack1").addClass("none"),$("#listTrack2").addClass("none"),$("#listArtist0").addClass("none"),$("#listArtist1").addClass("none"),$("#listArtist2").addClass("none"),$(`#listTrack${e}`).removeClass("none"),$(`#listArtist${e}`).removeClass("none"),$("#timeSelector0").removeClass("selected").removeClass("selectedLight"),$("#timeSelector1").removeClass("selected").removeClass("selectedLight"),$("#timeSelector2").removeClass("selected").removeClass("selectedLight"),$(`#timeSelector${e}`).addClass(t?"selectedLight":"selected"),w=e};$("#trackSelector").off().on("click",()=>{h(0)}),$("#artistSelector").off().on("click",()=>{h(1)}),$("#timeSelector0").off().on("click",()=>{g(0)}),$("#timeSelector1").off().on("click",()=>{g(1)}),$("#timeSelector2").off().on("click",()=>{g(2)});const p=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("black","white")),$("#theme_check").removeClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.remove("aLight");let t=$(".selectedLight");for(i=0;i<t.length;i++)t[i].classList.replace("selectedLight","selected");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight");window.localStorage.dark=!1}},u=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight")};"false"==window.localStorage.dark&&u(),$("#theme").off().on("click",p);
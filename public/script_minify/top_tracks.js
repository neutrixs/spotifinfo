let t=!1;const e=async function(i){return new Promise((e,t)=>{setTimeout(e,i)})},o=async function(){if(t)for(;t;)await e(100);else{t=!0;let e;e=await fetch("/gettoken"),e=await e.json(),e.relogback?l(!1):(window.localStorage.token=e.data.token,window.localStorage.validuntil=e.data.validuntil,t=!1)}},s=async function(){let t;if(t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),t=await t.json(),t.error)401!=t.error.status&&400!=t.error.status||(await o(),await e(1e3),await s());else{let e;e=t.images[0]?t.images[0].url:"/img/user.png",$("#profile").attr("src",e)}},l=function(e){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),e&&(window.localStorage.force=!0),window.location.replace("/")};let a=!1;const n=function(){a=a?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};let r=!1;$("#profile_h").click(function(){r=!0,n()}),$("#dropdown_options").click(function(){r=!0}),$("#logout").click(function(){l(!0)}),$(window).click(function(){r?r=!1:a&&n()}),isLoggedOut||s();const d=function(){$("#holder").addClass("margin0")},c=function(){$("#holder").removeClass("margin0")};let m=44.5;$(window).width()/parseFloat($("body").css("font-size"))<m&&d(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){this.innerWidth;($(window).width()/parseFloat($("body").css("font-size"))<m?d:c)()};const h=async function(d){var c="createElement",m="setAttribute",f="items",w="appendChild";if(!(2<d)){let r;if(r=await fetch("https://api.spotify.com/v1/me/top/tracks?limit=50&time_range="+["long_term","medium_term","short_term"][d],{method:"GET",headers:{Authorization:window.localStorage.token}}),r=await r.json(),r.error)401!=r.error.status&&400!=r.error.status||(await o(),await h(d));else{for(document.getElementById(`listTrack${d}`).innerHTML="",i=0;i<r[f].length;i++){let e=document[c]("div");e[m]("id",`listTrack${d}N${i}`),e[m]("class","list");let t=document[c]("div");t[m]("class","listNumber"),t.innerHTML=i+1;let o=document[c]("div");o[m]("id",`listTrack${d}N${i}AlbumHolder`),o[m]("class","listTrackAlbumHolder");let s=document[c]("img");s[m]("id",`listTrack${d}N${i}Album`),s[m]("class","listTrackAlbum"),s[m]("src",r[f][i].album.images[1].url);let l=document[c]("div");l[m]("id",`listTrack${d}N${i}InfoHolder`),l[m]("class","listTrackInfoHolder");let a=document[c]("div");a[m]("class","listTrackTitle"),a.innerHTML=r[f][i].name;let n=document[c]("div");for(j=0;j<r[f][i].artists.length;j++)n.innerHTML+=r[f][i].artists[j].name,j!=r[f][i].artists.length-1&&(n.innerHTML+=", ");l[w](a),l[w](n),o[w](s),e[w](t),e[w](o),e[w](l),document.getElementById(`listTrack${d}`).appendChild(e)}for(i=0;i<r[f].length;i++)$(`#listTrack${d}N${i}AlbumHolder`).off().on("click",{res:r,i:i},function(e){e=e.data.res.items[e.data.i].album.external_urls.spotify;isMobile()?location.href=e:window.open(e)}),$(`#listTrack${d}N${i}InfoHolder`).off().on("click",{res:r,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)})}}},w=async function(r){var d="createElement",c="setAttribute",m="items",f="appendChild";if(!(2<r)){let n;if(n=await fetch("https://api.spotify.com/v1/me/top/artists?limit=50&time_range="+["long_term","medium_term","short_term"][r],{method:"GET",headers:{Authorization:window.localStorage.token}}),n=await n.json(),n.error)401!=n.error.status&&400!=n.error.status||(await o(),await w(r));else{for(document.getElementById(`listArtist${r}`).innerHTML="",i=0;i<n[m].length;i++){let e=document[d]("div");e[c]("id",`listArtist${r}N${i}`),e[c]("class","list");let t=document[d]("div");t[c]("class","listNumber"),t.innerHTML=i+1;let o=document[d]("div");o[c]("id",`listArtist${r}N${i}ProfileHolder`),o[c]("class","listArtistProfileHolder");let s=document[d]("img");s[c]("id",`listArtist${r}N${i}Profile`),s[c]("class","listArtistProfile"),s[c]("src",n[m][i].images[1].url);let l=document[d]("div");l[c]("id",`listArtist${r}N${i}InfoHolder`),l[c]("class","listArtistInfoHolder");let a=document[d]("p");a[c]("id",`listArtist${r}N${i}Info`),a[c]("class","listArtistInfo"),a.innerHTML=n[m][i].name,o[f](s),l[f](a),e[f](t),e[f](o),e[f](l),document.getElementById(`listArtist${r}`)[f](e)}for(i=0;i<n[m].length;i++)$(`#listArtist${r}N${i}ProfileHolder`).off().on("click",{res:n,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)}),$(`#listArtist${r}N${i}InfoHolder`).off().on("click",{res:n,i:i},function(e){e=e.data.res.items[e.data.i].external_urls.spotify;isMobile()?location.href=e:window.open(e)})}}};h(0),h(1),h(2),w(0),w(1),w(2);let f=0,u=0;const g=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0);$("#listTrack").addClass("none"),$("#listArtist").addClass("none"),$(`#list${["Track","Artist"][e]}`).removeClass("none"),f=e,$("#trackSelector").removeClass("selected").removeClass("selectedLight"),$("#artistSelector").removeClass("selected").removeClass("selectedLight"),$(`#${["track","artist"][e]}Selector`).addClass(t?"selectedLight":"selected")},p=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0),$("#listTrack0").addClass("none"),$("#listTrack1").addClass("none"),$("#listTrack2").addClass("none"),$("#listArtist0").addClass("none"),$("#listArtist1").addClass("none"),$("#listArtist2").addClass("none"),$(`#listTrack${e}`).removeClass("none"),$(`#listArtist${e}`).removeClass("none"),$("#timeSelector0").removeClass("selected").removeClass("selectedLight"),$("#timeSelector1").removeClass("selected").removeClass("selectedLight"),$("#timeSelector2").removeClass("selected").removeClass("selectedLight"),$(`#timeSelector${e}`).addClass(t?"selectedLight":"selected"),u=e};$("#trackSelector").off().on("click",()=>{g(0)}),$("#artistSelector").off().on("click",()=>{g(1)}),$("#timeSelector0").off().on("click",()=>{p(0)}),$("#timeSelector1").off().on("click",()=>{p(1)}),$("#timeSelector2").off().on("click",()=>{p(2)});const k=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("black","white")),$("#theme_check").removeClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.remove("aLight");let t=$(".selectedLight");for(i=0;i<t.length;i++)t[i].classList.replace("selectedLight","selected");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight");window.localStorage.dark=!1}},v=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight")};"false"==window.localStorage.dark&&v(),$("#theme").off().on("click",k);
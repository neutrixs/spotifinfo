let t=!1;const e=async function(i){return new Promise((e,t)=>{setTimeout(e,i)})},l=async function(){if(t)for(;t;)await e(100);else{t=!0;let e;e=await fetch("/gettoken"),e=await e.json(),e.relogback?o(!1):(window.localStorage.token=e.data.token,window.localStorage.validuntil=e.data.validuntil,t=!1)}},s=async function(){let t;if(t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),t=await t.json(),t.error)401!=t.error.status&&400!=t.error.status||(await l(),await e(1e3),await s());else{let e;e=t.images[0]?t.images[0].url:"/img/user.png",$("#profile").attr("src",e)}},o=function(e){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),e&&(window.localStorage.force=!0),window.location.replace("/")};let a=!1;const r=function(){a=a?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};let n=!1;$("#profile_h").click(function(){n=!0,r()}),$("#dropdown_options").click(function(){n=!0}),$("#logout").click(function(){o(!0)}),$(window).click(function(){n?n=!1:a&&r()}),isLoggedOut||s();const d=function(){$("#holder").addClass("margin0")},c=function(){$("#holder").removeClass("margin0")};let m=44.5;$(window).width()/parseFloat($("body").css("font-size"))<m&&d(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){this.innerWidth;($(window).width()/parseFloat($("body").css("font-size"))<m?d:c)()};const f=async function(o){if(!(2<o)){let e,t,s;if(t=["long_term","medium_term","short_term"],e=await fetch("https://api.spotify.com/v1/me/top/tracks?limit=50&time_range="+t[o],{method:"GET",headers:{Authorization:window.localStorage.token}}),e=await e.json(),e.error)401!=e.error.status&&400!=e.error.status||(await l(),await f(o));else{for(s="",i=0;i<e.items.length;i++){for(s+=`<div id="listTrack${o}N${i}" class="list"><div class="listNumber">${i+1}</div><div id="listTrack${o}N${i}AlbumHolder" class="listTrackAlbumHolder"><img id="listTrack${o}N${i}Album" class="listTrackAlbum" src="${e.items[i].album.images[1].url}"></div><div id="listTrack${o}N${i}InfoHolder" class="listTrackInfoHolder"><div class="listTrackTitle">${e.items[i].name}</div><div class="listTrackArtist">`,j=0;j<e.items[i].artists.length;j++)s+=e.items[i].artists[j].name,j!==e.items[i].artists.length-1&&(s+=", ");s+="</div></div></div>"}for($(`#listTrack${o}`).html(s),s="",i=0;i<e.items.length;i++)s+=`$('#listTrack${o}N${i}AlbumHolder').off().on('click',()=>{url = '${e.items[i].album.external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}});$('#listTrack${o}N${i}InfoHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}})\n`;eval(s)}}},w=async function(o){if(!(2<o)){let e,t,s;if(t=["long_term","medium_term","short_term"],e=await fetch("https://api.spotify.com/v1/me/top/artists?limit=50&time_range="+t[o],{method:"GET",headers:{Authorization:window.localStorage.token}}),e=await e.json(),e.error)401!=e.error.status&&400!=e.error.status||(await l(),await w(o));else{for(s="",i=0;i<e.items.length;i++)s+=`<div id="listArtist${o}N${i}" class="list"><div class="listNumber">${i+1}</div><div id="listArtist${o}N${i}ProfileHolder" class="listArtistProfileHolder"><img id="listArtist${o}N${i}Profile" class="listArtistProfile" src="${e.items[i].images[1].url}"></div><div id="listArtist${o}N${i}InfoHolder" class="listArtistInfoHolder"><p id="listArtist${o}N${i}Info" class="listArtistInfo">${e.items[i].name}</p></div></div>`;for($(`#listArtist${o}`).html(s),s="",i=0;i<e.items.length;i++)s+=`$('#listArtist${o}N${i}ProfileHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}});$('#listArtist${o}N${i}InfoHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}})\n`;eval(s)}}};f(0),f(1),f(2),w(0),w(1),w(2);let h=0,g=0;const u=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0);$("#listTrack").addClass("none"),$("#listArtist").addClass("none"),$(`#list${["Track","Artist"][e]}`).removeClass("none"),h=e,$("#trackSelector").removeClass("selected").removeClass("selectedLight"),$("#artistSelector").removeClass("selected").removeClass("selectedLight"),$(`#${["track","artist"][e]}Selector`).addClass(t?"selectedLight":"selected")},p=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0),$("#listTrack0").addClass("none"),$("#listTrack1").addClass("none"),$("#listTrack2").addClass("none"),$("#listArtist0").addClass("none"),$("#listArtist1").addClass("none"),$("#listArtist2").addClass("none"),$(`#listTrack${e}`).removeClass("none"),$(`#listArtist${e}`).removeClass("none"),$("#timeSelector0").removeClass("selected").removeClass("selectedLight"),$("#timeSelector1").removeClass("selected").removeClass("selectedLight"),$("#timeSelector2").removeClass("selected").removeClass("selectedLight"),$(`#timeSelector${e}`).addClass(t?"selectedLight":"selected"),g=e};$("#trackSelector").off().on("click",()=>{u(0)}),$("#artistSelector").off().on("click",()=>{u(1)}),$("#timeSelector0").off().on("click",()=>{p(0)}),$("#timeSelector1").off().on("click",()=>{p(1)}),$("#timeSelector2").off().on("click",()=>{p(2)});const k=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("black","white")),$("#theme_check").removeClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.remove("aLight");let t=$(".selectedLight");for(i=0;i<t.length;i++)t[i].classList.replace("selectedLight","selected");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight");window.localStorage.dark=!1}},v=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight")};"false"==window.localStorage.dark&&v(),$("#theme").off().on("click",k);
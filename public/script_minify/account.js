currentFetch=!1;const o=async function(e){return new Promise((o,t)=>{setTimeout(o,e)})},e=async function(){if(currentFetch)for(;currentFetch;)await o(100);else{currentFetch=!0;let o;o=await fetch("/gettoken"),o=await o.json(),o.relogback?t(!1):(window.localStorage.token=o.data.token,window.localStorage.validuntil=o.data.validuntil,currentFetch=!1)}},n=async function(){let t;if(t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),t=await t.json(),t.error)401!=t.error.status&&400!=t.error.status||(await e(),await o(1e3),await n());else{let o;o=t.images[0]?t.images[0].url:"/img/user.png",$("#profile").attr("src",o)}},t=function(o){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(o){document.cookie=o.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),o&&(window.localStorage.force=!0),window.location.replace("/")};isDropdownOpened=!1;const a=function(){isDropdownOpened=isDropdownOpened?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};isDropdownLocked=!1,$("#profile_h").click(function(){isDropdownLocked=!0,a()}),$("#dropdown_options").click(function(){isDropdownLocked=!0}),$("#logout").click(function(){t(!0)}),$(window).click(function(){isDropdownLocked?isDropdownLocked=!1:isDropdownOpened&&a()}),isLoggedOut||n();const s=function(){$("#holder").addClass("margin0")},d=function(){$("#holder").removeClass("margin0")};let r=44.5;$(window).width()/parseFloat($("body").css("font-size"))<r&&s(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){width=this.innerWidth,emWidth=$(window).width()/parseFloat($("body").css("font-size")),(emWidth<r?s:d)()};const l=async function(){let o=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}});var t;o=await o.json(),o.error?401!=o.error.status&&400!=o.error.status||(await e(),await l()):($("#accountName").html(o.display_name),t=`<p class="listAccountInfo">Email: <span class="copy">${o.email}</span></p><p class="listAccountInfo">ID: <span class="copy">${o.id}</span></p><p class="listAccountInfo">Followers: ${o.followers.total}</p><p class="listAccountInfo">Plan: ${"premium"==o.product?"premium":"free"}</p>`,$("#accountInfo").html($("#accountInfo").html()+t),$("#profilePic").attr("src",o.images[0]?o.images[0].url:"/img/user.png"),o.images[0]||$("#profilePic").css("box-shadow","none"))};l();const c=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("black","white")),$("#theme_check").removeClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.remove("aLight");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.add("aLight");window.localStorage.dark=!1}},w=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.add("aLight")};"false"==window.localStorage.dark&&w(),$("#theme").off().on("click",c);
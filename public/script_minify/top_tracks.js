currentFetch=!1;const e=async function(i){return new Promise((e,t)=>{setTimeout(e,i)})},l=async function(){if(currentFetch)for(;currentFetch;)await e(100);else{currentFetch=!0;let e;e=await fetch("/gettoken"),e=await e.json(),e.relogback?t(!1):(window.localStorage.token=e.data.token,window.localStorage.validuntil=e.data.validuntil,currentFetch=!1)}},o=async function(){let t;if(t=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),t=await t.json(),t.error)401!=t.error.status&&400!=t.error.status||(await l(),await e(1e3),await o());else{let e;e=t.images[0]?t.images[0].url:"/img/user.png",$("#profile").attr("src",e)}},t=function(e){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),e&&(window.localStorage.force=!0),window.location.replace("/")};isDropdownOpened=!1;const s=function(){isDropdownOpened=isDropdownOpened?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};isDropdownLocked=!1,$("#profile_h").click(function(){isDropdownLocked=!0,s()}),$("#dropdown_options").click(function(){isDropdownLocked=!0}),$("#logout").click(function(){t(!0)}),$(window).click(function(){isDropdownLocked?isDropdownLocked=!1:isDropdownOpened&&s()}),isLoggedOut||o();const r=function(){$("#holder").addClass("margin0")},a=function(){$("#holder").removeClass("margin0")};let n=44.5;$(window).width()/parseFloat($("body").css("font-size"))<n&&r(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){width=this.innerWidth,emWidth=$(window).width()/parseFloat($("body").css("font-size")),(emWidth<n?r:a)()};const d=async function(s){if(!(2<s)){let e,t,o;if(t=["long_term","medium_term","short_term"],e=await fetch("https://api.spotify.com/v1/me/top/tracks?limit=50&time_range="+t[s],{method:"GET",headers:{Authorization:window.localStorage.token}}),e=await e.json(),e.error)401!=e.error.status&&400!=e.error.status||(await l(),await d(s));else{for(o="",i=0;i<e.items.length;i++){for(o+=`<div id="listTrack${s}N${i}" class="list"><div class="listNumber">${i+1}</div><div id="listTrack${s}N${i}AlbumHolder" class="listTrackAlbumHolder"><img id="listTrack${s}N${i}Album" class="listTrackAlbum" src="${e.items[i].album.images[1].url}"></div><div id="listTrack${s}N${i}InfoHolder" class="listTrackInfoHolder"><div class="listTrackTitle">${e.items[i].name}</div><div class="listTrackArtist">`,j=0;j<e.items[i].artists.length;j++)o+=e.items[i].artists[j].name,j!==e.items[i].artists.length-1&&(o+=", ");o+="</div></div></div>"}for($(`#listTrack${s}`).html(o),o="",i=0;i<e.items.length;i++)o+=`$('#listTrack${s}N${i}AlbumHolder').off().on('click',()=>{url = '${e.items[i].album.external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}});$('#listTrack${s}N${i}InfoHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}})\n`;eval(o)}}},c=async function(s){if(!(2<s)){let e,t,o;if(t=["long_term","medium_term","short_term"],e=await fetch("https://api.spotify.com/v1/me/top/artists?limit=50&time_range="+t[s],{method:"GET",headers:{Authorization:window.localStorage.token}}),e=await e.json(),e.error)401!=e.error.status&&400!=e.error.status||(await l(),await c(s));else{for(o="",i=0;i<e.items.length;i++)o+=`<div id="listArtist${s}N${i}" class="list"><div class="listNumber">${i+1}</div><div id="listArtist${s}N${i}ProfileHolder" class="listArtistProfileHolder"><img id="listArtist${s}N${i}Profile" class="listArtistProfile" src="${e.items[i].images[1].url}"></div><div id="listArtist${s}N${i}InfoHolder" class="listArtistInfoHolder"><p id="listArtist${s}N${i}Info" class="listArtistInfo">${e.items[i].name}</p></div></div>`;for($(`#listArtist${s}`).html(o),o="",i=0;i<e.items.length;i++)o+=`$('#listArtist${s}N${i}ProfileHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}});$('#listArtist${s}N${i}InfoHolder').off().on('click',()=>{url = '${e.items[i].external_urls.spotify}';if(isMobile()){location.href = url}else{window.open(url)}})\n`;eval(o)}}};d(0),d(1),d(2),c(0),c(1),c(2),typeSelected=0,timeSelected=0;const m=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0);$("#listTrack").addClass("none"),$("#listArtist").addClass("none"),$(`#list${["Track","Artist"][e]}`).removeClass("none"),typeSelected=e,$("#trackSelector").removeClass("selected").removeClass("selectedLight"),$("#artistSelector").removeClass("selected").removeClass("selectedLight"),$(`#${["track","artist"][e]}Selector`).addClass(t?"selectedLight":"selected")},f=function(e){let t=!1;"false"==window.localStorage.dark&&(t=!0),$("#listTrack0").addClass("none"),$("#listTrack1").addClass("none"),$("#listTrack2").addClass("none"),$("#listArtist0").addClass("none"),$("#listArtist1").addClass("none"),$("#listArtist2").addClass("none"),$(`#listTrack${e}`).removeClass("none"),$(`#listArtist${e}`).removeClass("none"),$("#timeSelector0").removeClass("selected").removeClass("selectedLight"),$("#timeSelector1").removeClass("selected").removeClass("selectedLight"),$("#timeSelector2").removeClass("selected").removeClass("selectedLight"),$(`#timeSelector${e}`).addClass(t?"selectedLight":"selected"),timeSelected=e};$("#trackSelector").off().on("click",()=>{m(0)}),$("#artistSelector").off().on("click",()=>{m(1)}),$("#timeSelector0").off().on("click",()=>{f(0)}),$("#timeSelector1").off().on("click",()=>{f(1)}),$("#timeSelector2").off().on("click",()=>{f(2)});const w=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("black","white")),$("#theme_check").removeClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.remove("aLight");let t=$(".selectedLight");for(i=0;i<t.length;i++)t[i].classList.replace("selectedLight","selected");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight");window.localStorage.dark=!1}},h=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#dropdown").html($("#dropdown").html().replace("white","black")),$("#theme_check").addClass("none");let e=$("a");for(i=0;i<e.length;i++)e[i].classList.add("aLight");let t=$(".selected");for(i=0;i<t.length;i++)t[i].classList.replace("selected","selectedLight")};"false"==window.localStorage.dark&&h(),$("#theme").off().on("click",w);
const o=function(){$("#holder").addClass("margin0"),$("#nowPlaying").addClass("nowPlayingMobile")},e=function(){$("#holder").removeClass("margin0"),$("#nowPlaying").removeClass("nowPlayingMobile")};let a=44.5;$(window).width()/parseFloat($("body").css("font-size"))<a&&o(),$("#holder").removeClass("none").addClass("ts300ms"),window.onresize=function(){this.innerWidth;($(window).width()/parseFloat($("body").css("font-size"))<a?o:e)()};const t=function(){if("false"==window.localStorage.dark){$("body")[0].classList.remove("bodyLight"),$("#nav").removeClass("navLight"),$("#dropdown_options").removeClass("dropdown_optionsLight"),$("#theme_check").removeClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.remove("aLight");window.localStorage.dark=!0}else{$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#theme_check").addClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.add("aLight");window.localStorage.dark=!1}},n=function(){$("body")[0].classList.add("bodyLight"),$("#nav").addClass("navLight"),$("#dropdown_options").addClass("dropdown_optionsLight"),$("#theme_check").addClass("none");let o=$("a");for(i=0;i<o.length;i++)o[i].classList.add("aLight")};"false"==window.localStorage.dark&&n(),$("#theme").off().on("click",t);let s=!1;const l=async function(a){return new Promise((o,e)=>{setTimeout(o,a)})},d=async function(){if(s)for(;s;)await l(100);else{s=!0;let o;o=await fetch("/gettoken"),o=await o.json(),o.relogback?c(!1):(window.localStorage.token=o.data.token,window.localStorage.validuntil=o.data.validuntil,s=!1)}},r=async function(){let e;if(e=await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:window.localStorage.token}}),e=await e.json(),e.error)401!=e.error.status&&400!=e.error.status||(await d(),await l(1e3),await r());else{let o;o=e.images[0]?e.images[0].url:"/img/user.png",$("#profile").attr("src",o)}},c=function(o){delete window.localStorage.token,delete window.localStorage.validuntil,delete window.localStorage.force,document.cookie.split(";").forEach(function(o){document.cookie=o.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),o&&(window.localStorage.force=!0),window.location.replace("/")};let w=!1;const g=function(){w=w?($("#dropdown").removeClass("r180"),$("#dropdown_options").addClass("none"),!1):($("#dropdown").addClass("r180"),$("#dropdown_options").removeClass("none"),!0)};let h=!1;$("#profile_h").click(function(){h=!0,g()}),$("#dropdown_options").click(function(){h=!0}),$("#logout").click(function(){c(!0)}),$(window).click(function(){h?h=!1:w&&g()}),isLoggedOut||r();